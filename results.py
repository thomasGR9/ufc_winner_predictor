import pickle
from keras.models import load_model
import pandas as pd
import re
import warnings
from pathlib import Path
warnings.filterwarnings("ignore")




BASE_DIR = Path(__file__).resolve(strict=True).parent

unique_fighters_stats_final = pd.read_csv(f"{BASE_DIR}/unique_fighters_stats_final.csv")







R_weight_classes = ["R_Women's Featherweight_rank", "R_Women's Strawweight_rank", "R_Women's Bantamweight_rank", 'R_Heavyweight_rank', 'R_Light Heavyweight_rank', 'R_Middleweight_rank', 'R_Welterweight_rank', 'R_Lightweight_rank', 'R_Featherweight_rank', 'R_Bantamweight_rank', 'R_Flyweight_rank']
B_weight_classes = ["B_Women's Featherweight_rank", "B_Women's Strawweight_rank", "B_Women's Bantamweight_rank", 'B_Heavyweight_rank', 'B_Light Heavyweight_rank', 'B_Middleweight_rank', 'B_Welterweight_rank', 'B_Lightweight_rank', 'B_Featherweight_rank', 'B_Bantamweight_rank', 'B_Flyweight_rank']
mixed_dif = ['loss_dif', 'ko_dif', 'height_dif', 'reach_dif', 'age_dif', 'sig_str_dif', 'avg_sub_att_dif', 'avg_td_dif', 'win_streak_dif', 'longest_win_streak_dif', 'win_dif', 'total_round_dif', 'sub_dif']
mixed_B = ['B_losses', 'B_win_by_KO/TKO', 'B_Height_cms', 'B_Reach_cms', 'B_age', 'B_avg_SIG_STR_landed', 'B_avg_SUB_ATT', 'B_avg_TD_landed', 'B_current_win_streak', 'B_longest_win_streak', 'B_wins', 'B_total_rounds_fought', 'B_win_by_Submission']
mixed_R = ['R_losses', 'R_win_by_KO/TKO', 'R_Height_cms', 'R_Reach_cms', 'R_age', 'R_avg_SIG_STR_landed', 'R_avg_SUB_ATT', 'R_avg_TD_landed', 'R_current_win_streak', 'R_longest_win_streak', 'R_wins', 'R_total_rounds_fought', 'R_win_by_Submission']
cols_in_order = ['B_avg_SIG_STR_pct', 'B_avg_TD_pct', 'B_win_by_Decision_Split', 'B_Height_cms', 'B_Reach_cms', 'R_avg_SIG_STR_pct', 'R_avg_TD_pct', 'R_win_by_Decision_Split', 'R_Height_cms', 'R_Reach_cms', 'R_age', 'B_age', 'win_streak_dif', 'longest_win_streak_dif', 'win_dif', 'loss_dif', 'total_round_dif', 'ko_dif', 'sub_dif', 'height_dif', 'reach_dif', 'age_dif', 'sig_str_dif', 'avg_sub_att_dif', 'avg_td_dif', 'Rank_dif', 'sqrt_B_avg_SIG_STR_landed', 'sqrt_B_avg_TD_landed', 'sqrt_B_longest_win_streak', 'sqrt_B_total_rounds_fought', 'sqrt_B_wins', 'sqrt_R_avg_SIG_STR_landed', 'sqrt_R_avg_TD_landed', 'sqrt_R_longest_win_streak', 'sqrt_R_total_rounds_fought', 'sqrt_R_wins', 'cbrt_B_current_win_streak', 'cbrt_B_avg_SUB_ATT', 'cbrt_B_losses', 'cbrt_R_current_win_streak', 'cbrt_R_avg_SUB_ATT', 'cbrt_R_losses']
sqrt_cols = ['B_avg_SIG_STR_landed', 'B_avg_TD_landed', 'B_longest_win_streak', 'B_total_rounds_fought', 'B_wins', 'R_avg_SIG_STR_landed', 'R_avg_TD_landed', 'R_longest_win_streak', 'R_total_rounds_fought', 'R_wins']
cbrt_cols = ['B_current_win_streak', 'B_avg_SUB_ATT', 'B_losses', 'R_current_win_streak', 'R_avg_SUB_ATT', 'R_losses']
Threshold_prec_dict = {
 0.5: 0.584,
 0.51: 0.588,
 0.52: 0.593,
 0.53: 0.595,
 0.54: 0.59,
 0.55: 0.601,
 0.56: 0.601,
 0.57: 0.599,
 0.58: 0.591,
 0.59: 0.592,
 0.6: 0.595,
 0.61: 0.597,
 0.62: 0.601,
 0.63: 0.611,
 0.64: 0.613,
 0.65: 0.606,
 0.66: 0.602,
 0.67: 0.614,
 0.68: 0.62,
 0.69: 0.621,
 0.7: 0.625,
 0.71: 0.627,
 0.72: 0.639,
 0.73: 0.655,
 0.74: 0.661,
 0.75: 0.688,
 0.76: 0.705,
 0.77: 0.716,
 0.78: 0.708,
 0.79: 0.705,
 0.8: 0.711,
 0.81: 0.741,
 0.82: 0.711,
 0.83: 0.741,
 0.84: 0.836,
 0.85: 0.875,
 0.86: 0.868,
 0.87: 0.885
}

fighters_in_weight_classes = {115: ['lomalookboonmee',
  'naliang',
  'ninanunes',
  'kayhansen',
  'caludiagadelha',
  'maiastevenson',
  'izabelabadurek',
  'angelahill',
  'jessicapenne',
  'gloriadepaula',
  'ashleyyoder',
  'montserratconejo',
  'virnajandiroba',
  'carlaesparza',
  'michellewaterson',
  'luanapinheiro',
  'samhughes',
  'rosenamajunas',
  'jessicaandrade',
  'arianecarnelossi',
  'loopygodinez',
  'mackenziedern',
  'jinhyufrey',
  'amandalemos',
  'mallorymartin',
  'corymckenna',
  'kanakomurata',
  'yanxiaonan',
  'polianabotelho',
  'randamarkos',
  'hannahcifers',
  'emilywhitmire',
  'livinhasouza',
  'marinarodriguez',
  'paigevanzant',
  'briannavanburen',
  'joannajedrzejczyk',
  'syurikondo',
  'polyanaviana',
  'jodieesquibel',
  'zhangweili',
  'alexandraalbu',
  'ninaansaroff',
  'jessicaaguilar',
  'weilizhang',
  'amandacooper',
  'feliceherrig',
  'alexchambers',
  'karolinakowalkiewicz',
  'tatianasuarez',
  'teciatorres',
  'cortneycasey',
  'julianalima',
  'angelamagana',
  'vivianepereira',
  'chanmijeon',
  'jamiemoyle',
  'danielletaylor',
  'pearlgonzalez',
  'heatherjoclark',
  'kailincurran',
  'cristinastanciu',
  'claudiagadelha',
  'jocelynjoneslybarger',
  'annaelmose',
  'seoheeham',
  'emilypeterskagan',
  'valerieletourneau',
  'erickaalmeida',
  'lisaellis',
  'aislingdaly',
  'tinalahdemaki',
  'jessicarakoczy'],
 125: ['victorialeonardo',
  'aoriqileng',
  'sumudaerji',
  'wuyanan',
  'jimmyflick',
  'mariyaagapova',
  'christinamarks',
  'karinegevorgyan',
  'arielbeck',
  'richievaculik',
  'paddyholohan',
  'nolanticman',
  'bentleysyler',
  'willcampuzano',
  'caseyoneill',
  'laurenmurphy',
  'cynthiacalvillo',
  'tailasantos',
  'mandybohm',
  'hannahgoldy',
  'jiyeonkim',
  'vanessademopoulos',
  'brandonroyval',
  'odeosbourne',
  'melissagatto',
  'zarrukhadashev',
  'raulianpaiva',
  'mayceebarber',
  'elisereed',
  'malcolmgordon',
  'jessicaeye',
  'jeromerivera',
  'laraprocopio',
  'brandonmoreno',
  'joannecalderwood',
  'arianelipski',
  'tabatharicci',
  'victorrodriguez',
  'juancamiloronderos',
  'rogeriobontorin',
  'vivianearaujo',
  'antoninashevchenko',
  'luanacarolina',
  'jeffmolina',
  'justinekish',
  'mirandamaverick',
  'matheusnicolau',
  'jjaldrich',
  'askaraskarov',
  'jordanespinosa',
  'alexagrasso',
  'manelkape',
  'amandaribas',
  'zhalgaszhumagulov',
  'tysonnam',
  'manonfiorot',
  'codydurden',
  'rachaelostovich',
  'alexperez',
  'jennifermaia',
  'mirandagranger',
  'liliyashakirova',
  'tagirulanbekov',
  'daviddvorak',
  'mararomeroborella',
  'andrealee',
  'montanadelarosa',
  'shanadobson',
  'mizukiinoue',
  'josephbenavidez',
  'amiralbazi',
  'ryanbenoit',
  'lianajojua',
  'zhalgaszhamagulov',
  'gillianrobertson',
  'marynamoroz',
  'deivesonfigueiredo',
  'mollymccann',
  'sarahfrota',
  'luciepudilova',
  'mattschnell',
  'katlynchookagian',
  'lizcarmouche',
  'lucipudilova',
  'laurenmueller',
  'dianabelbita',
  'isabeladepauda',
  'kaikarafrance',
  'alexandrepantoja',
  'nadiakassem',
  'dustinortiz',
  'bennguyen',
  'ulkasasaki',
  'ericshelton',
  'roxannemodafferi',
  'jussierformiga',
  'jarredbrooks',
  'kalindrafaria',
  'josetorres',
  'eliasgarcia',
  'barbhonchak',
  'naokiinoue',
  'melindafabian',
  'johnmoraga',
  'ashleeevanssmith',
  'josephmorales',
  'jessicaroseclark',
  'ashkanmokhtarian',
  'marcobeltran',
  'magomedbibulatov',
  'valentinashevchenko',
  'wilsonreis',
  'hectorsandoval',
  'robertosanchez',
  'neilseery',
  'carlsjohndetomas',
  'becrawlings',
  'fredyserrano',
  'geaneherrera',
  'jenellausa',
  'justinscoggins',
  'alibagautinov',
  'veronicamacedo',
  'williegates',
  'chriskelades',
  'zachmakovsky',
  'dannymartinez',
  'jondelosreyes',
  'chicocamus',
  'chrisbeal',
  'vaughanlee',
  'joshuasampo',
  'yaozhikui',
  'kyojihoriguchi',
  'shanehowell',
  'louisgaudinot',
  'chriscariaso',
  'tatekimatsuda',
  'ianmccall',
  'philharris',
  'alptekinozkilic',
  'roldansangchaan',
  'darrellmontague',
  'josemaria',
  'iliardesantos',
  'azamatgashimov',
  'darrenuyenoyama',
  'ulyssesgomez',
  'marcosvinicius',
  'demetriousjohnson',
  'joshferguson',
  'yasuhirourushitani'],
 135: ['erinblanchfield',
  'rickyturcios',
  'manamartinez',
  'johnnymunoz',
  'adrianyanez',
  'franciscofigueiredo',
  'juliaavila',
  'aiemannzahabi',
  'umarnurmagomedov',
  'geraldodefreitas',
  'alialqaisi',
  'mayrabuenosilva',
  'peteryan',
  'filippejic',
  'brunokorea',
  'jessamynduke',
  'jumabieketuerxun',
  'rolanddelorme',
  'chrisholdsworth',
  'juliekedzie',
  'migueltorres',
  'norifumiyamamoto',
  'karolrosa',
  'gaetanopirrello',
  'shannayoung',
  'johnnyeduardo',
  'merabdvalishvili',
  'tonygravely',
  'raquelpennington',
  'jpbuys',
  'sarahalpar',
  'liudviksholinian',
  'bradyhiestand',
  'guidocannetti',
  'saidyokubkakhramonov',
  'domingopilarte',
  'josianenunes',
  'pedromunhoz',
  'caseykenney',
  'drakorodriguez',
  'andersondossantos',
  'jameysimmons',
  'tjdillashaw',
  'randycosta',
  'andreewell',
  'mieshatate',
  'sergeymorozov',
  'yanakunitskaya',
  'krismoutinho',
  'timurvaliev',
  'julijastoliarenko',
  'daveygrant',
  'alexisdavis',
  'codygarbrandt',
  'priscilacachoeira',
  'felipecolares',
  'anthonybirchak',
  'jackshore',
  'gustavolopez',
  'macychiasson',
  'jessestrader',
  'rayrodriguez',
  'aljamainsterling',
  'kylerphillips',
  'jimmierivera',
  'sabinamazo',
  'ronnielawrence',
  'johncastaneda',
  'frankieedgar',
  'saramcmann',
  'joselyneedwards',
  'vanessamelo',
  'marlonvera',
  'robfont',
  'panniekianzad',
  'josequinonez',
  'natemaness',
  'khalidtaha',
  'markstriegl',
  'corysandhagen',
  'tonykelley',
  'stephanieegger',
  'irenealdana',
  'juliannapena',
  'cameronelse',
  'heilialateng',
  'sijaraeubanks',
  'irwinrivera',
  'aliqaisi',
  'monteljackson',
  'aaronphillips',
  'josealdo',
  'marionreneau',
  'markdelarosa',
  'ginamazany',
  'seanomalley',
  'rayborg',
  'sarahmoras',
  'dominickcruz',
  'beamalecki',
  'journeynewson',
  'hollyholm',
  'nohelinhernandez',
  'songyadong',
  'nathanielwood',
  'aspenladd',
  'rickysimon',
  'niccomontano',
  'gabrielsilva',
  'jinsooson',
  'mariobautista',
  'brandondavis',
  'andresoukhamthath',
  'danaabatgerel',
  'milesjohns',
  'ryanmacdonald',
  'carloshuachin',
  'bethecorreia',
  'linalansberg',
  'timelliott',
  'bostonsalmon',
  'odeobsourne',
  'tracycortez',
  'liupingyuan',
  'saidnurmagomedov',
  'germainederandamie',
  'urijahfaber',
  'marlonmoraes',
  'petryan',
  'grigoriipopov',
  'colesmith',
  'frankiesaenz',
  'alejandroperez',
  'lukesanders',
  'kyunghokang',
  'sergiopettis',
  'matthewlopez',
  'bryancaraway',
  'martinday',
  'louissmolka',
  'jobysanchez',
  'talitabernardo',
  'tonyaevinger',
  'terrionware',
  'johndodson',
  'iurialcantara',
  'henrycejudo',
  'brettjohns',
  'wulijiburen',
  'raonibarcelos',
  'bradkatona',
  'patrickwilliams',
  'ketlenvieira',
  'russelldoane',
  'joesoto',
  'benitolopez',
  'bharatkandare',
  'ricardoramos',
  'raniyahya',
  'albertmorales',
  'terutoishihara',
  'damianstasiak',
  'eddiewineland',
  'cindydandois',
  'tomduquesnoy',
  'augustomendes',
  'reginaldovieira',
  'michinoritanaka',
  'rondarousey',
  'johnlineker',
  'bradpickett',
  'takeyamizugaki',
  'manvelgamburyan',
  'milanadudieva',
  'kwanhokwak',
  'felipearantes',
  'leandroissa',
  'elizabethphillips',
  'erikperez',
  'raphaelassuncao',
  'dilenolopes',
  'jerrodsanders',
  'lesliesmith',
  'rinnakai',
  'kellyfaszholz',
  'masanorikanehara',
  'taylorlapilus',
  'scottjorgensen',
  'georgeroop',
  'sirwankakai',
  'romansalazar',
  'henrybriones',
  'leonardomorales',
  'roystonwee',
  'sarahkaufman',
  'shaynabaszler',
  'codygibson',
  'mitchgagnon',
  'dustinkimura',
  'ianentwistle',
  'franciscorivera',
  'matthobar',
  'timgorman',
  'marcusbrimage',
  'larissapacheco',
  'johnnybedford',
  'alexisdufresne',
  'mikeeaston',
  'yvesjabouin',
  'hugoviana',
  'shunichishimizu',
  'davegalera',
  'michaelmcdonald',
  'namphan',
  'peggymorgan',
  'edwinfigueroa',
  'juniorhernandez',
  'sheilagaff',
  'rosisexton',
  'dustinpague',
  'isseitamura',
  'reubenduran',
  'motonobutezuka',
  'byronbloodworth',
  'johnalbert',
  'jeffhougland',
  'walelwatson',
  'jaredpapazian',
  'nickdenis',
  'damaciopage',
  'brianbowles',
  'alexsoto',
  'nickpace',
  'coleescovedo',
  'jeffcurran',
  'josephsandoval',
  'donnywalker',
  'jasonreinhardt',
  'kenstone',
  'charlievalencia',
  'antoniobanuelos'],
 145: ['jamallemmers',
  'collinanglin',
  'joshculibao',
  'criscyborg',
  'luizgaragorri',
  'tylerdiamond',
  'mattbessette',
  'wangguan',
  'alanomer',
  'justinlawrence',
  'brendanloughnane',
  'anistaviomedeiros',
  'johnteixeira',
  'tysongriffin',
  'joestevenson',
  'fredsonpaixao',
  'jaredgordon',
  'brianortega',
  'omarmorales',
  'charlesjourdain',
  'gigachikadze',
  'patsabatini',
  'luissaldana',
  'melsikbaghdasaryan',
  'darrickminner',
  'billyquarantillo',
  'iliatopuria',
  'justinjaynes',
  'danige',
  'rickyglenn',
  'hakeemdawodu',
  'stevenpeterson',
  'kamuelakirk',
  'youssefzalal',
  'normadumont',
  'billalgeo',
  'shayilannuerdanbieke',
  'edsonbarboza',
  'mikegrundy',
  'michaeltrizano',
  'cubswanson',
  'codystamann',
  'tjbrown',
  'kevinnatividad',
  'sodiqyusuff',
  'jordangriffin',
  'thomasalmeida',
  'grantdawson',
  'gavintucker',
  'marcelorojo',
  'megananderson',
  'aaloncruz',
  'dannychavez',
  'julianerosa',
  'briankelleher',
  'chrisgutierrez',
  'movsarevloev',
  'douglassilvadeandrade',
  'calvinkattar',
  'austinlingo',
  'danielpineda',
  'peterbarrett',
  'damonjackson',
  'kaikamaka',
  'eduardogaragorri',
  'andrefili',
  'chansungjung',
  'jonathanmartinez',
  'makwanamirkhani',
  'zubairatukhugov',
  'tjlaramie',
  'hunterazure',
  'austinspringer',
  'vincecachero',
  'nadnarimani',
  'leronemurphy',
  'chrisfishgold',
  'maxholloway',
  'dannyhenry',
  'shaneburgos',
  'feliciaspencer',
  'chasehooper',
  'herbertburns',
  'spikecarlyle',
  'vincemorales',
  'darrenelkins',
  'charlesrosa',
  'zarahfairn',
  'arnoldallen',
  'mirsadbektic',
  'sheymonmoraes',
  'ryanhall',
  'yoshinorihorie',
  'seungwoochoi',
  'youssefzalel',
  'humbertobandenay',
  'bobbymoffett',
  'natelandwehr',
  'krongracie',
  'jeremystephens',
  'mannybermudez',
  'seanwoodson',
  'renanbarao',
  'sumanmokhtarian',
  'alexandervolkanovski',
  'danielteymur',
  'jacobkilburn',
  'mattsayles',
  'sungbinjo',
  'dudasantana',
  'michaeljohnson',
  'jordanrinaldi',
  'zabitmagomedsharipov',
  'mylesjury',
  'austinarnett',
  'renatomoicano',
  'amandanunes',
  'kylebochniak',
  'leahletson',
  'yairrodriguez',
  'artemlobov',
  'rickglenn',
  'chadmendes',
  'martinbravo',
  'brycemitchell',
  'shaneyoung',
  'madsburnell',
  'jeremykennedy',
  'godofredopepey',
  'julioarce',
  'enriquebarzola',
  'doohochoi',
  'mikesantiago',
  'joshemmett',
  'gabrielbenitez',
  'alexcaceres',
  'rolandody',
  'gilbertmelendez',
  'diegorivas',
  'jasonknight',
  'dennissiver',
  'mikedelatorre',
  'phillipenover',
  'ningguangyou',
  'chrisavila',
  'maximoblanco',
  'samsicilia',
  'ronyjason',
  'horaciogutierrez',
  'tatsuyakawajiri',
  'thiagotavares',
  'fernandobruno',
  'ricardolamas',
  'lucasmartins',
  'markeddiva',
  'chasskelly',
  'yaotzinmeza',
  'masiofullen',
  'robwhiteford',
  'diegobrandao',
  'tiagotrator',
  'paulredmond',
  'levanmakashvili',
  'noadlahat',
  'claycollard',
  'yuichulnam',
  'jimyhettes',
  'rockylee',
  'robertperalta',
  'katsunorikikuno',
  'catzingano',
  'alextorres',
  'colemiller',
  'jimalers',
  'humbertobrown',
  'rodolforubio',
  'mikewilkinson',
  'ernestchavez',
  'dashonjohnson',
  'tomniinimaki',
  'jianpingyang',
  'juanpuig',
  'niklasbackstrom',
  'akiracorassani',
  'stevensiler',
  'ivanmenjivar',
  'andyogle',
  'willchope',
  'estevanpayan',
  'kevinsouza',
  'hatsuhioki',
  'joshclopton',
  'jeremylarsen',
  'bartpalaszewski',
  'pablogarza',
  'mattgrice',
  'joshgrispi',
  'miltonvieira',
  'jonathanbrookins',
  'joeygambino',
  'diegonunes',
  'tommyhayden',
  'eijimitsuoka',
  'michihiroomigawa',
  'wagnercampos',
  'patschilling',
  'eddieyagin',
  'ericwisely',
  'antoniocarvalho',
  'juniorassuncao',
  'stephenbass',
  'dustinneace',
  'jasonyoung',
  'kennyflorian',
  'mikelullo',
  'ianloveland',
  'javiervazquez',
  'markhominick',
  'leonardgarcia',
  'mackenssemerzier',
  'mikebrown',
  'tylertoner',
  'waylonlowe'],
 155: ['devontesmith',
  'urosmedic',
  'paddypimblett',
  'rafaelalves',
  'ottmanazaitar',
  'caludiopuelles',
  'alexgorgees',
  'devinpowell',
  'jaycucciniello',
  'jasonsaggo',
  'glaicofranca',
  'cesararzamendia',
  'yancabral',
  'ramseynijem',
  'joeellenberger',
  'coltonsmith',
  'cristianomarcello',
  'georgesotiropoulos',
  'ryancouture',
  'tiequanzhang',
  'maciejjewtuszko',
  'sakochivitchian',
  'seansherk',
  'stevelopez',
  'robemerson',
  'caoluno',
  'mikebreeden',
  'jamiemullarkey',
  'nasrathaqparast',
  'jalinturner',
  'christosgiagos',
  'brandonjenkins',
  'luigivendramini',
  'markmadsen',
  'austinhubbard',
  'ignaciobahamondes',
  'rafaelfiziev',
  'rafagarcia',
  'thiagomoises',
  'mateuszgamrot',
  'conormcgregor',
  'jaiherbert',
  'damirhadzovic',
  'bradriddell',
  'terrancemckinney',
  'jordanleavitt',
  'damirismagulov',
  'michaelchandler',
  'beneildariush',
  'tuckerlutz',
  'seansoriano',
  'gregorgillespie',
  'rongzhu',
  'alexandermunoz',
  'dakotabush',
  'joesolecki',
  'khamaworthy',
  'drewdober',
  'kevincroom',
  'clayguida',
  'masonjones',
  'charlesoliveira',
  'rafaeldosanjos',
  'alexanderhernandez',
  'justingaethje',
  'alexanderyakovlev',
  'guramkutateladze',
  'faresziam',
  'jessinayari',
  'alexdasilva',
  'ludovitklein',
  'kylenelson',
  'alanpatrick',
  'vincpichel',
  'scottholtzman',
  'alexmunoz',
  'bobbygreen',
  'jesseronson',
  'joelalvarez',
  'armantsarukyan',
  'romanbogatov',
  'danhooker',
  'rooseveltroberts',
  'maxrohskopf',
  'kevinaguilar',
  'brokweaver',
  'donaldcerrone',
  'johnmakdessi',
  'drakkarklose',
  'stevegarcia',
  'magomedmustafaev',
  'joshuaculibao',
  'marcopoloreyes',
  'danmoret',
  'luispena',
  'kazulavargas',
  'yancymedeiros',
  'franciscotrinaldo',
  'donghyunma',
  'dustinpoirier',
  'paulfelder',
  'daviramos',
  'diegoferreira',
  'teemupackalen',
  'marcosmariano',
  'danilobelluardo',
  'landovannata',
  'niklentz',
  'jamesvick',
  'thomasgifford',
  'jonathanpearce',
  'stevieray',
  'omarantoniomoralesferrer',
  'mattwiman',
  'leonardosantos',
  'kurtholobaugh',
  'mikedavis',
  'jasongonzalez',
  'mattfrevola',
  'desmondgreen',
  'jesuspinedo',
  'joeduffy',
  'poloreyes',
  'davidteymur',
  'teedwards',
  'aliaquinta',
  'joaquimsilva',
  'darrellhorcher',
  'johngunther',
  'donmadge',
  'evandunham',
  'kajanjohnson',
  'alexwhite',
  'jontuck',
  'olivieraubinmercier',
  'islammakhachev',
  'rosspearson',
  'alvaroherrera',
  'marcdiakiese',
  'joegiannetti',
  'richiesmullen',
  'allanzuniga',
  'gleisontibau',
  'felipesilva',
  'nickhein',
  'chrisgruetzemacher',
  'thibaultgouti',
  'mizutohirota',
  'abeltrujillo',
  'willbrooks',
  'michelquinones',
  'jimmiller',
  'adrianomartins',
  'andrewholbrook',
  'chriswade',
  'erikkoch',
  'johnnycase',
  'michaelmcbride',
  'joeproctor',
  'rashidmagomedov',
  'rezamadadi',
  'alessandroricci',
  'jccottrell',
  'bjpenn',
  'marcinheld',
  'rustamkhabilov',
  'tonyferguson',
  'claudiopuelles',
  'jasonnovelli',
  'joeygomez',
  'taehyunbang',
  'leandrosilva',
  'damienbrown',
  'codypfister',
  'joelauzon',
  'takanorigomi',
  'eddiealvarez',
  'mitchclarke',
  'mehdibaghdad',
  'lukaszsajewski',
  'shanecampbell',
  'hacrandias',
  'justinsalas',
  'martinsvensson',
  'kjnoons',
  'felipeolivieri',
  'daroncruickshank',
  'tonysims',
  'dannycastillo',
  'marcinwrzosek',
  'abnerlloveras',
  'leokuntz',
  'akbarharreola',
  'piotrhallmann',
  'mickaellebout',
  'yusukekasuya',
  'nazarenomalegarie',
  'frankieperez',
  'eliassilverio',
  'ivanjorge',
  'leonardomafra',
  'justinedwards',
  'normanparke',
  'davidmichaud',
  'caincarrizosa',
  'samstout',
  'valmirlazaro',
  'joshshockley',
  'rodrigodelima',
  'anthonychristodoulou',
  'rodrigodamm',
  'garettwhiteley',
  'isaacvallieflagg',
  'dennisbermudez',
  'chrisheatherly',
  'jorgedeoliveira',
  'charliebrenneman',
  'vagnerrocha',
  'naoyukikotani',
  'yosdeniscedeno',
  'anthonynjokuani',
  'jakelindsey',
  'marcinbandel',
  'efrainescudero',
  'pathealy',
  'jasonhigh',
  'benwall',
  'khabibnurmagomedov',
  'mairbektaisumov',
  'franciscotrevino',
  'melvinguillard',
  'zhanglipeng',
  'joshthomson',
  'mikerio',
  'quinnmulhern',
  'fabriciocamoes',
  'macdanzig',
  'codymckenzie',
  'rogerbowling',
  'reneeforte',
  'kazukitokudome',
  'rafaellooliveira',
  'johnmaguire',
  'tjgrant',
  'johncholish',
  'colinfletcher',
  'antonkuivanen',
  'carosfodor',
  'cjkeith',
  'jamievarner',
  'mikericci',
  'johncofer',
  'henrymartinez',
  'carloprater',
  'shaneroller',
  'yoislandyizquierdo',
  'spencerfisher',
  'bernardomagalhaes',
  'christickle',
  'chrissaunders',
  'paulsass',
  'marcuslevesseur',
  'kamalshalorus',
  'johnalessio',
  'terryetim',
  'dennishallman',
  'yvesedwards',
  'shamarbailey',
  'edwardfaaloloto',
  'dannydownes',
  'graymaynard',
  'aaronriley',
  'tjobrien',
  'andrewinner',
  'curtwarburton',
  'kylewatson',
  'paulkelly',
  'gaberuediger',
  'willamyfreire',
  'antoniomckee',
  'aaronwilkinson',
  'paultaylor',
  'markholst',
  'pataudinwood',
  'johngunderson',
  'jacobvolkmann',
  'kurtpellegrino',
  'danlauzon',
  'joebrammer',
  'mattveach',
  'ronystorres',
  'markbocek',
  'shannongugerty'],
 170: ['philrowe',
  'louiscosce',
  'callanpotter',
  'vincenteluque',
  'cmpunk',
  'charlieward',
  'erickmontano',
  'augustomontano',
  'vernonramos',
  'mikeswick',
  'williampatolino',
  'saiwang',
  'thiagoperpetuo',
  'albertcheng',
  'chrisspang',
  'jonmanley',
  'matthughes',
  'chuckoneil',
  'ryanmcgillivray',
  'philbaroni',
  'karoparisyan',
  'jameswilks',
  'mattserra',
  'yoshiyukiyoshida',
  'nikoprice',
  'robbielawler',
  'martinsano',
  'carlstonharris',
  'davidzawada',
  'danielrodriguez',
  'ramizbrahimaj',
  'vicenteluque',
  'jaredgooden',
  'jasonwitt',
  'orioncosce',
  'prestonparsons',
  'stephenthompson',
  'maxgriffin',
  'michelpereira',
  'nicolasdalby',
  'michelprazeres',
  'jeremiahwells',
  'dhiegolima',
  'matthewsemelsberger',
  'natediaz',
  'belalmuhammad',
  'miguelbaeza',
  'muslimsalikhov',
  'claudiosilva',
  'alexmorono',
  'geoffneal',
  'jorgemasvidal',
  'randybrown',
  'stefansekulic',
  'tristanconnelly',
  'sashapalatnikov',
  'abubakarnurmagomedov',
  'jakematthews',
  'gilbertburns',
  'philiprowe',
  'neilmagny',
  'mounirlazzez',
  'mattbrown',
  'lijingliang',
  'ramazanemeev',
  'khaoswilliams',
  'carltonminus',
  'takashisato',
  'timmeans',
  'rhysmckee',
  'shavkatrakhmonov',
  'jameskrause',
  'courtmcgee',
  'tyronwoodley',
  'zelimimadaev',
  'bartoszfabinski',
  'christianaguilera',
  'dwightgrant',
  'petersobotta',
  'niklasstolze',
  'mickeygall',
  'lymangood',
  'anthonyroccomartin',
  'makipitolo',
  'gabegreen',
  'alekseikunchenko',
  'ismailnaurdiev',
  'emilmeek',
  'songkenan',
  'roccomartin',
  'benaskren',
  'michaelchiesa',
  'chancerencountre',
  'leonedwards',
  'kylestewart',
  'salimtouahri',
  'colewilliams',
  'kalinnwilliams',
  'mikeperry',
  'elizeudossantos',
  'derrick',
  'alexoliveira',
  'rostemakman',
  'hectoraldana',
  'seanbrady',
  'dannyroberts',
  'sergeykhandozhko',
  'colbycovington',
  'bensaunders',
  'frankcamacho',
  'kevinlee',
  'derrickkrantz',
  'sergiomoraes',
  'kyleprepolec',
  'keitanakamura',
  'anthonypettis',
  'gunnarnelson',
  'curtismillender',
  'zakottow',
  'kamaruusman',
  'carlopedersoli',
  'bryanbarberena',
  'siyarbahadurzada',
  'rickyrainey',
  'santiagoponzinibbio',
  'thiagoalves',
  'craigwhite',
  'warlleyalves',
  'georgesullivan',
  'daichiabe',
  'mikejackson',
  'nordinetaleb',
  'chadlaprise',
  'sultanaliev',
  'alexgarcia',
  'luanchagas',
  'yushinokami',
  'oliverenkamp',
  'alanjouban',
  'briancamozzi',
  'galorebofando',
  'ericksilva',
  'bobbynash',
  'bojanvelickovic',
  'diegosanchez',
  'lukejumeau',
  'hyungyulim',
  'alexreyes',
  'demianmaia',
  'elizeuzaleskidossantos',
  'jessetaylor',
  'tomgallicchio',
  'dominiquesteele',
  'jimmywallhead',
  'nathancoy',
  'patrickcote',
  'joshuaburkman',
  'roancarneiro',
  'tarecsaffiedine',
  'brendanoreilly',
  'jonathanmeunier',
  'alberttumenov',
  'hectorurbina',
  'kennyrobertson',
  'seanspencer',
  'carloscondit',
  'sabahhomasi',
  'lorenzlarkin',
  'jakeellenberger',
  'jamesmoontasri',
  'enriquemarin',
  'antonzafir',
  'albertomina',
  'rickstory',
  'dominicwaters',
  'michaelgraves',
  'viscardiandrade',
  'edgargarcia',
  'mikepierce',
  'johnhoward',
  'andreasstahl',
  'stevekennedy',
  'gasanumalatov',
  'sagenorthcutt',
  'rogerzapata',
  'ronstallings',
  'pawelpawlak',
  'mattdwyer',
  'hayderhassan',
  'rorymacdonald',
  'brandonthatch',
  'joemerritt',
  'lewisgonzalez',
  'cathalpendred',
  'jonavinwebb',
  'bradleyscott',
  'chrisclements',
  'sheldonwestcott',
  'ryanlaflare',
  'joshkoscheck',
  'richardwalsh',
  'kiichikunimoto',
  'bensonhenderson',
  'matsnilsson',
  'mikerhodes',
  'brianebersole',
  'amirsadollah',
  'takenorisato',
  'wendelloliveira',
  'jordanmein',
  'donghyunkim',
  'dannymitchell',
  'shinshoanzai',
  'nicomusoke',
  'andrewcraig',
  'vikgrujic',
  'lancebenoist',
  'wagnersilva',
  'sethbaczynski',
  'hernaniperpetuo',
  'kylenoke',
  'chrisindich',
  'johnhathaway',
  'anyingwang',
  'tjwaldburger',
  'luizdutra',
  'bobbyvoelker',
  'anthonylapsley',
  'adlanamagov',
  'jakeshields',
  'igoraraujo',
  'davidmitchell',
  'martinkampmann',
  'brianmelancon',
  'bennyalloway',
  'mikepyle',
  'bristolmarunde',
  'nahshonburrell',
  'joaozeferino',
  'adamcella',
  'besamyousef',
  'joshneer',
  'brockjardine',
  'yurivillefort',
  'jorgesantiago',
  'jayhieron',
  'pascalkrauss',
  'jameshead',
  'rousimarpalhares',
  'manuelrodriguez',
  'paulothiago',
  'duaneludwig',
  'simeonthoresen',
  'damarquesjohnson',
  'danstittgen',
  'luisramos',
  'ricardofunch',
  'carloseduardorocha',
  'seanpierson',
  'jorgelopez',
  'chemills',
  'jakehecht',
  'chriscope',
  'danielroberts',
  'clayharvison',
  'paulbradley',
  'keithwisniewski',
  'mikestumpf',
  'chrislytle',
  'yoshihiroakiyama',
  'aaronsimpson',
  'richattonito',
  'claudepatrick',
  'danhardy',
  'krismccray',
  'mikeguymon',
  'amilcaralves',
  'marcusdavis',
  'gregsoto',
  'dustinhazelett',
  'ricardoalmeida',
  'brianfoster',
  'nickosipczak',
  'markscanlon',
  'juliopaulino',
  'forrestpetz',
  'matthewriddle',
  'jesselennox',
  'pauldaley',
  'jonathangoulet',
  'bradblackburn',
  'jonfitch',
  'rorymarkham'],
 185: ['codybrundage',
  'bryanbattle',
  'andrepetroski',
  'punahelesoriano',
  'rodolfovieira',
  'philhawes',
  'romankopylov',
  'junyongpark',
  'khalidmurtazaliev',
  'adamyandiev',
  'bubbabush',
  'ricardoabreu',
  'dylanandrews',
  'luizcane',
  'delsonheleno',
  'jessebongfeldt',
  'kendallgrove',
  'geraldharris',
  'keithjardine',
  'jamieyager',
  'joshbryant',
  'davidloiseau',
  'jesseforbes',
  'natequarry',
  'krzysztofjotko',
  'nickmaximov',
  'antonioarroyo',
  'darrentill',
  'marcandrebarriault',
  'gilberturbina',
  'michealgillmore',
  'geraldmeerschaert',
  'abdulrazakalhassan',
  'wellingtonturman',
  'kelvingastelum',
  'seanstrickland',
  'brendanallen',
  'ianheinisch',
  'jordanwilliams',
  'dustinstoltzfus',
  'dricusduplessis',
  'bradtavares',
  'brunosilva',
  'marvinvettori',
  'laureanostaropoli',
  'gregoryrodrigues',
  'edmenshahbazyan',
  'andremuniz',
  'jamiepickett',
  'kyledaukaus',
  'kbbhullar',
  'chrisweidman',
  'jacobmalkoun',
  'kevinholland',
  'julianmarquez',
  'abuazaitar',
  'israeladesanya',
  'nassourdineimavov',
  'anthonyhernandez',
  'makhmudmuradov',
  'antoniocarlosjunior',
  'tombreese',
  'markusperez',
  'alessiodichirico',
  'duskotodorovic',
  'jacaresouza',
  'bevonlewis',
  'andersonsilva',
  'charlieontiveros',
  'jackmarshman',
  'jaredcannonier',
  'philliphawes',
  'johnphillips',
  'joaquinbuckley',
  'paulocosta',
  'anthonyivy',
  'impakasanganay',
  'zakcummings',
  'khamzatchimaev',
  'andreasmichailidis',
  'oskarpiechota',
  'erykanders',
  'yoelromero',
  'deronwinn',
  'ericspicely',
  'cezarferreira',
  'krzystofjotko',
  'andrewsanchez',
  'karlroberson',
  'omariakhmedov',
  'trevingiles',
  'eliastheodorou',
  'jackhermansson',
  'alenamedovski',
  'charlesbyrd',
  'hectorlombard',
  'cbdollaway',
  'timwilliams',
  'lyotomachida',
  'derekbrunson',
  'oluwalebamgbose',
  'ryanjanes',
  'danielkelly',
  'georgesstpierre',
  'davidbranch',
  'uriahhall',
  'robwilkinson',
  'robertwhittaker',
  'johnyhendricks',
  'natemarquardt',
  'alexnicholson',
  'chriscamozzi',
  'gegardmousasi',
  'scottaskham',
  'timboetsch',
  'danhenderson',
  'tamdanmccrory',
  'leonardoaugustoleleco',
  'caiomagalhaes',
  'kevincasey',
  'joegigliotti',
  'joshsamman',
  'michaelbisping',
  'vitormiranda',
  'albertouda',
  'vitorbelfort',
  'garrethmclellan',
  'rafaelnatal',
  'marceloguimaraes',
  'thalesleites',
  'chrisdempsey',
  'joeriggs',
  'elvismutapcic',
  'marcioalexandrejunior',
  'stevemontgomery',
  'tomwatson',
  'ildemaralcantara',
  'eddiegordon',
  'antoniodossantos',
  'costasphilippou',
  'lukebarnatt',
  'justinjones',
  'rogernarvaez',
  'patrickwalsh',
  'andyenz',
  'brunosantos',
  'cungle',
  'mikeking',
  'guilhermevasconcelos',
  'antoniobraganeto',
  'richardsonmoreira',
  'lukezachrich',
  'timkennedy',
  'brianhouston',
  'jamestehuna',
  'danielsarafian',
  'markmunoz',
  'michaelkuiper',
  'joeybeltran',
  'tortroeng',
  'magnuscedenblad',
  'bubbamcdaniel',
  'papyabedi',
  'rogergracie',
  'eddiemendez',
  'karlosvemola',
  'alanbelcher',
  'gilbertsmith',
  'collinhart',
  'jimmyquinlan',
  'nickdiaz',
  'nickcatone',
  'alessiosakara',
  'tomdeblass',
  'buddyroberts',
  'nickring',
  'rikifukuda',
  'richfranklin',
  'dongiyang',
  'stevecantwell',
  'ronnymarkes',
  'cliffordstarks',
  'dustinjacoby',
  'ericschafer',
  'mikemassenzio',
  'jasonmiller',
  'jasonmacdonald',
  'danmiller',
  'jaredhamman',
  'chrisleben',
  'timcredeur',
  'ryanjensen',
  'jorgerivera',
  'maiquelfalcao',
  'robkimmons',
  'joedoerksen',
  'mariomiranda',
  'johnsalter',
  'stevesteinbeiss',
  'jameshammortree',
  'renzogracie',
  'luciolinhares'],
 205: ['jimcrute',
  'daunjung',
  'shamilgamzatov',
  'gokhansaki',
  'keithberish',
  'coryhendricks',
  'wanderleisilva',
  'tomblackledge',
  'sethpetruzelli',
  'rodneywallace',
  'chuckliddell',
  'johnnywalker',
  'ryanspann',
  'devinclark',
  'tafonnchukwi',
  'khalilrountreejr',
  'darrenstewart',
  'fabiocherant',
  'edherman',
  'ovincesaintpreux',
  'danilomarques',
  'ikevillanueva',
  'nicolaenegumereanu',
  'jamahalhill',
  'jiriprochazka',
  'jimmycrute',
  'williamknight',
  'michaloleksiejczuk',
  'romandolidze',
  'aleksandarrakic',
  'carlosulberg',
  'magomedankalaev',
  'marcinprachnio',
  'viniciusmoreira',
  'johnallan',
  'paulcraig',
  'jordanwright',
  'gloverteixeira',
  'justinledet',
  'ioncutelaba',
  'modestasbukauskas',
  'alanbaudot',
  'janblachowicz',
  'aleksacamur',
  'mikerodriguez',
  'alonzomenifield',
  'rogerionogueira',
  'alexandergustafsson',
  'gadzhimuradantigulov',
  'khadisibragimov',
  'klidsonabreu',
  'samalvey',
  'nikitakrylov',
  'saparbegsafarov',
  'dequantownsend',
  'thiagosantos',
  'lukerockhold',
  'kennedynzechukwu',
  'dominickreyes',
  'darkostosic',
  'dalchalungiambula',
  'trevorsmith',
  'anthonysmith',
  'coreyanderson',
  'tysonpedro',
  'rashadcoulter',
  'patrickcummins',
  'jordanjohnson',
  'jamesbochnovic',
  'adammilstead',
  'volkanoezdemir',
  'francimarbarroso',
  'mishacirkunov',
  'huyaozong',
  'marcelfortuna',
  'jonathanwilson',
  'henriquedasilva',
  'abdulkerimedilov',
  'rashadevans',
  'gianvillante',
  'nickroehrick',
  'jeremykimball',
  'anthonyjohnson',
  'joachimchristensen',
  'seanoconnell',
  'jimimanuwa',
  'bojanmihajlovic',
  'joshstansbury',
  'clinthester',
  'stevebosse',
  'tomlawlor',
  'rafaelfeijao',
  'ryanbader',
  'danieljolly',
  'hansstringer',
  'ryanjimmo',
  'fabiomaldonado',
  'stanislavnedkov',
  'igorpokrajac',
  'gutoinocente',
  'phildavis',
  'mattvanburen',
  'danielspohn',
  'franciscarmont',
  'anthonyperosh',
  'chaelsonnen',
  'matthamill',
  'rogerhollett',
  'vinnymagalhaes',
  'brianstann',
  'cyrillediabate',
  'vladimirmatyushenko',
  'codydonovan',
  'chadgriggs',
  'stephanbonnar',
  'wagnerprado',
  'titoortiz',
  'thiagosilva',
  'aaronrosa',
  'nickpenner',
  'ednaldooliveira',
  'kylekingsbury',
  'jasonbrilz',
  'mattlucas',
  'eliotmarshall',
  'rampagejackson',
  'ricardoromero',
  'forrestgriffin',
  'krzysztofsoszynski',
  'randycouture',
  'jonjones',
  'toddbrown',
  'goranreljic',
  'alexandreferreira',
  'mauriciorua',
  'tomaszdrwal',
  'jamesirvin'],
 265: ['joshparisian',
  'alexandrromanov',
  'bensosoli',
  'alekandervolkov',
  'jamesmulheron',
  'nandorguelmino',
  'brocklesnar',
  'jonmadsen',
  'jamesmcsweeney',
  'kevinferguson',
  'jairzinhorozenstruik',
  'chrisdaukaus',
  'sergheispivac',
  'chasesherman',
  'cirylgane',
  'rodrigonascimento',
  'greghardy',
  'alexandervolkov',
  'roquemartinez',
  'jakecollier',
  'augustosakai',
  'marcintybura',
  'ilirlatifi',
  'jaredvanderaa',
  'chrisbarnett',
  'juanespino',
  'jarjisdanho',
  'francisngannou',
  'harryhunsucker',
  'maximgrishin',
  'derricklewis',
  'tomaspinall',
  'justintafa',
  'parkerporter',
  'tannerboser',
  'waltharris',
  'taituivasa',
  'carlosfelipe',
  'jeffhughes',
  'danielcormier',
  'alekseioleinik',
  'raphaelpessoa',
  'mauricegreene',
  'philipelins',
  'fabriciowerdum',
  'yorgandecastro',
  'marcosrogeriodelima',
  'juniordossantos',
  'junioralbini',
  'juanadams',
  'benrothwell',
  'raphaelpessoanunes',
  'stipemiocic',
  'shamilabdurakhimov',
  'dontalemayes',
  'sergeipavlovich',
  'blagoyivanov',
  'dmitriismoliakov',
  'marcelogolm',
  'justinwillis',
  'cainvelasquez',
  'allencrowder',
  'justinfrazier',
  'michelbatista',
  'stefanstruve',
  'curtisblaydes',
  'chrisdelarocha',
  'danielspitz',
  'adamwieczorek',
  'dmitrysosnovskiy',
  'andreiarlovski',
  'cyrilasker',
  'markgodbeer',
  'christiancolombo',
  'zuanyanwu',
  'arjanbhullar',
  'alistairovereem',
  'markhunt',
  'roynelson',
  'timjohnson',
  'luishenrique',
  'travisbrowne',
  'viktorpesta',
  'anthonyhamilton',
  'danielomielanczuk',
  'antoniosilva',
  'joshbarnett',
  'damiangrabowski',
  'codyeast',
  'gabrielgonzaga',
  'frankmir',
  'jaredrosholt',
  'mattmitrione',
  'konstantinerokhin',
  'ruslanmagomedov',
  'minotauronogueira',
  'soapalelei',
  'toddduffee',
  'mirkocrocop',
  'joshcopeland',
  'ruanpotts',
  'brendanschaub',
  'jackmay',
  'shawnjordan',
  'brandonvera',
  'daveherman',
  'cheickkongo',
  'philipdefries',
  'lavarjohnson',
  'shanedelrosario',
  'olithompson',
  'mikerussow',
  'jonolaveinemo',
  'christianmorecraft',
  'robbroughton',
  'patbarry',
  'christuchscherer',
  'timhague',
  'seanmccorkle',
  'gilbertyvel',
  'viniciusqueiroz',
  'jamestoney',
  'shanecarwin',
  'mostaphaalturk',
  'paulbuentello',
  'chasegormley']}




def X_from_names(red_corner_name, blue_corner_name):
    

    #make the string transformations to make them the same form as the fighters column of the unique_fighters_stats_final dataset
    red_name_adj = re.sub(r'[^\w]', ' ', str(red_corner_name).lower()).replace(" ", "")
    blue_name_adj = re.sub(r'[^\w]', ' ', str(blue_corner_name).lower()).replace(" ", "")

    
    #checks if the fighters name are in the unique_fighters_stats_final['fighter'] column, if not returns the fact.
    if ((red_name_adj not in list(unique_fighters_stats_final['fighter'])) and (blue_name_adj not in list(unique_fighters_stats_final['fighter']))):
        error_message = "Both given names are not in the list"
        return error_message
    if red_name_adj not in list(unique_fighters_stats_final['fighter']):
        error_message = "The name given in the red corner is not in the list"
        return error_message
    if blue_name_adj not in list(unique_fighters_stats_final['fighter']):
        error_message = "The name given in the blue corner is not in the list"
        return error_message
    if red_name_adj == blue_name_adj:
        error_message = "You gave the same name in both corners"
        return error_message
    
    #checks if the fighters are in the same weight class using the fighters_in_weight_classes directory,returns a printed a message if not
    for pos_weight in fighters_in_weight_classes:
        for name in fighters_in_weight_classes[pos_weight]:
            if name == red_name_adj:
                red_weight = pos_weight  
    
    if blue_name_adj not in fighters_in_weight_classes[red_weight]:
        error_message = "The fighters are not in the same weight class"
        return error_message
    
    
    #if the name in the red corner is in the list, will save his features,add a prefix R_ on them and reset the index 
    if (red_name_adj in list(unique_fighters_stats_final['fighter'])):
        R_frame = unique_fighters_stats_final[unique_fighters_stats_final['fighter'] == red_name_adj]
        R_frame_adj = R_frame.add_prefix('R_')
        R_frame_adj = R_frame_adj.reset_index(drop=True)
   
    #same for the blue corner name
    if (blue_name_adj in list(unique_fighters_stats_final['fighter'])):
        B_frame = unique_fighters_stats_final[unique_fighters_stats_final['fighter'] == blue_name_adj]
        B_frame_adj = B_frame.add_prefix('B_')
        B_frame_adj = B_frame_adj.reset_index(drop=True)

    #will merge the two datasets and return the full one
    X_without_pre = pd.merge(R_frame_adj, B_frame_adj, left_index=True, right_index=True)
    return X_without_pre


def preprocessing(New_data):
    with open(f"{BASE_DIR}/Colum_transf.pkl", "rb") as f:
        Column_trans = pickle.load(f)

    with open(f"{BASE_DIR}/standar_pca_pipe.pkl", "rb") as f:
        standar_pca_pipeline = pickle.load(f)
        
    New_data.reset_index(drop=True, inplace=True)
    R_Series = []
    B_Series = []
    for j in range(New_data.shape[0]):
        R_Series.append(16)
        B_Series.append(16)
    
    for j in range(New_data.shape[0]):
        for column in R_weight_classes:
            if ~New_data.isna().iloc[j][column]:
                R_Series[j] = New_data.iloc[j][column]
    
    for j in range(New_data.shape[0]):
        for column in B_weight_classes:
            if ~New_data.isna().iloc[j][column]:
                B_Series[j] = New_data.iloc[j][column]

    New_data['R_rank'] = R_Series
    New_data['B_rank'] = B_Series
    New_data['B_rank'].replace(0, 16, inplace=True)
    New_data['R_rank'].replace(0, 16, inplace=True)
    
    New_data['Rank_dif'] = New_data['B_rank'] - New_data['R_rank']
    New_data.drop(["R_rank" ,"B_rank"], axis=1, inplace=True)
    
    
    for j in range(len(mixed_dif)):
        New_data[mixed_dif[j]] = New_data[mixed_B[j]] - New_data[mixed_R[j]]
    
    New_data_prepared = Column_trans.transform(New_data)
    New_data_prepared_df = pd.DataFrame(New_data_prepared, columns=Column_trans.get_feature_names_out(), index=New_data.index)
    
   
    for col in sqrt_cols:
        New_data_prepared_df['sqrt_'+col] = New_data_prepared_df[col]
    
    
    
    New_data_prepared_df.drop(['B_avg_SIG_STR_landed', 'B_avg_TD_landed', 'B_longest_win_streak', 'B_total_rounds_fought', 'B_wins', 'R_avg_SIG_STR_landed', 'R_avg_TD_landed', 'R_longest_win_streak', 'R_total_rounds_fought', 'R_wins'], axis=1, inplace=True)
    
    for col in cbrt_cols:
        New_data_prepared_df['cbrt_'+col] = New_data_prepared_df[col]
        
    New_data_prepared_df.drop(['B_current_win_streak', 'B_avg_SUB_ATT', 'B_losses', 'R_current_win_streak', 'R_avg_SUB_ATT', 'R_losses'], axis=1, inplace=True)
    
    
    
    New_data_prepared_df = New_data_prepared_df[cols_in_order]
    X_final = standar_pca_pipeline.transform(New_data_prepared_df)
    X_final_df = pd.DataFrame(X_final, columns=standar_pca_pipeline.get_feature_names_out(), index=New_data.index)
    return X_final_df
    


def meta_learner_input(test_set_x):
    with open(f"{BASE_DIR}/top_mod_RFC.pkl", "rb") as f:
        top_mod_RFC = pickle.load(f)

    with open(f"{BASE_DIR}/top_mod_XGB.pkl", "rb") as f:
        top_mod_XGB = pickle.load(f)

    with open(f"{BASE_DIR}/bayes.pkl", "rb") as f:
        bayes = pickle.load(f)

    top_mod_NN = load_model(f"{BASE_DIR}/61acc.h5")
    
    XGB_pred = top_mod_XGB.predict_proba(test_set_x)
    RFC_pred = top_mod_RFC.predict_proba(test_set_x)
    bayes_pred = bayes.predict_proba(test_set_x)
    NN_pred_win_one_ = top_mod_NN.predict(test_set_x)
    XGB_pred_win_one = pd.Series(XGB_pred[:, 1]).apply(lambda x: x/4).tolist()
    RFC_pred_win_one = pd.Series(RFC_pred[:, 1]).apply(lambda x: x/4).tolist()
    bayes_pred_win_one = pd.Series(bayes_pred[:, 1]).apply(lambda x: x/4).tolist()
    NN_pred_win_one = (NN_pred_win_one_ / 4)[:,0].tolist()
    df = pd.DataFrame(data = {'XGB_pred': XGB_pred_win_one, 'RFC_pred': RFC_pred_win_one, 'bayes_pred': bayes_pred_win_one, 'NN_pred': NN_pred_win_one})
    return df


def results(red_corner_name, blue_corner_name):
    with open(f"{BASE_DIR}/meta_learner.pkl", "rb") as f:
        meta_learner = pickle.load(f)
    X_New_Instance = X_from_names(red_corner_name = red_corner_name, blue_corner_name = blue_corner_name)
    if (type(X_New_Instance) == str):
        return X_New_Instance
    X_New_Instance_preprocessed_df =  preprocessing(New_data = X_New_Instance)
    meta_learner_input_df = meta_learner_input(test_set_x = X_New_Instance_preprocessed_df)
    preds = meta_learner.predict_proba(meta_learner_input_df)
    winner_blue_corner_proba = preds[:, 1]
    if (winner_blue_corner_proba[0] > 0.5):
        winner = "Blue corner"
        winner_probability = round(winner_blue_corner_proba[0], 2)
    elif (winner_blue_corner_proba[0] < 0.5):
        winner = "Red corner"
        winner_probability = round((1 - winner_blue_corner_proba[0]), 2)
    elif (winner_blue_corner_proba[0] == 0.5):
        output_message_eq = "The predicted probability is equal for both corners"
        return output_message_eq
    output_message = f"The winner is the fighter in the {winner} with predicted probability = {winner_probability}.With this predicted probability as threshold, the model achieved {Threshold_prec_dict[winner_probability]} precision in the test set."
    return output_message
    

